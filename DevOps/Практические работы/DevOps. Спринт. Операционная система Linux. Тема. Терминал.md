### ***ЧАСТЬ 1: МАТЕРИАЛ ДЛЯ ПОВТОРЕНИЯ***

***Шпаргалка по командам терминала:***

***Навигация и базовые операции:***
- `pwd` - показать текущую директорию 
- `ls` - список файлов и папок 
- `cd` - сменить директорию 
- `mkdir` - создать папку 
- `rm` - удалить файл 
- `cp` - копировать файлы 
- `mv` - переместить/переименовать 

***Работа с файлами:***
- `cat` - просмотреть весь файл 
- `less` - постраничный просмотр 
- `head/tail` - начало/конец файла 
- `tail -f` - отслеживать изменения в реальном времени 
- `grep` - поиска текста в файле 

***Права доступа:***
- `chmod` - изменить права (755, 644, 600)
- `chown` - изменить владельца 
- `sudo` - выполнить с правами root 

***Файловая система:***
- `df -h` - свободное место на диске 
- `du -sh` - размер файлов/папок 
- `mount/umount` - монтирование дисков 
- `find` - поиск файлов по критериям 

***Текстовые редакторы:***
- `nano` - простой редактор 
- `vim` - продвинутый редактор 

***Архивация:***
- `tar -czvf` - создать архив 
- `tar -xzvf` - распаковать архив 
### ***ЧАСТЬ 2: ПРАКТИЧЕСКОЕ ЗАДАНИЕ***

**Контекст:**  
Вы — DevOps-инженер в компании "ООО Рога и Копыта Tech". На сервере Kali Linux развернута тестовая среда компании. После увольнения предыдущего администратора обнаружены критические проблемы с безопасностью и организацией данных. Вам поручено провести срочный аудит и восстановить работоспособность системы.

**Критичные проблемы:**
- Конфигурационные файлы содержат секреты в открытом виде
- Некорректные права доступа к критичным данным
- Отсутствие системы мониторинга и бэкапов
- Подозрительная активность в системных логах

**Цель:**  
Провести комплексный аудит системы, устранить уязвимости безопасности и внедрить базовые практики DevOps.
### ***ЗАДАЧИ ДЛЯ ВЫПОЛНЕНИЯ:***

***Задача 1: Экстренная разведка и инвентаризация***
1. Определите текущее местоположение в файловой системе
2. Проведите полную инвентаризацию структуры `/opt/rogakiopyta/`
3. Найдите все файлы с расширением `.log` в системе компании
4. Составьте список 5 самых крупных файлов в инфраструктуре
5. Определите общий размер данных компании

***Решение:*** 
1. Использую команду `pwd` для просмотра текущего местоположения в ФС: 
![[Pasted image 20251122103850.png]]

2. Тут я использовал 3 команды для просмотра содержимого для изучения - `cd, ls, ls -la`: 
![[Pasted image 20251122104519.png]]

3. Тут я использовал команду `find`: 
![[Pasted image 20251122104855.png]]

4. Я использовал команду `du -sh, find, type, ls -lh` 
**Объяснение:**
- `du -sh` - показать размер папок (du = disk usage)
- `find /opt -type f` - найти все файлы в папке opt
- `ls -lh` - показать размер файлов понятно (в МБ, ГБ)
- `sort` - отсортировать по размеру
- `head -5` - показать только первые 5 результатов
![[Pasted image 20251122105510.png]]

5. Использую команду `du -sh`: 
![[Pasted image 20251122105626.png]]

***Вывод:*** Мы определили текущее местоположении в файловой системе с помощью команды `pwd`. Провел полную инвентаризацию структуры, полностью с ней ознакомился при помощи команд: `cd, ls, ls -la`. Нашел все файлы с расширением .log в системе компании используя команду `find`. Составил список 5 самых крупных файлов в инфраструктуре при помощи команды: `du -sh`, `find /opt -type f`, `ls -lh`, `sort`, `head -5`. И определил общий размер данных компании используя команду `du -sh`. Следующий наш шаг провести анализ угроз безопасности. 

***Задача 2: Анализ угроз безопасности***
1. Просканируйте системные логи на предмет подозрительной активности
2. Найдите все файлы, содержащие пароли, API-ключи и токены
3. Проверьте права доступа ко всем конфигурационным файлам
4. Выявите файлы с неправильными или опасными правами доступа
5. Составьте отчет о найденных уязвимостях

***Решение:*** 
1. Тут я использовал команду `cat` ,  данной командой я просмотрел логи инфраструктуры и в низ выявил подозрительную активность, а именно: 
- **ERROR** - ошибки
- **WARNING** - предупреждения
- **Unauthorized access attempt** - попытка несанкционированного доступа
![[Pasted image 20251129111640.png]]

2. На данном этапе я использовал команду `grep` с флагом `-r`, тем самым нашел файлы содержащие пароли, API-ключи и токены, это файлы: 
- **configs/database.conf**
- **www/config.php**
![[Pasted image 20251129112107.png]]

3. Тут я использую команду `ls -la`, она выводит мне все файлы и показывает у каких файлов какое разрешение, но нас интересуют файлы conf и я нашел такие и посмотрел какие у низ права доступа
- **configs** - у него права drwxr-xr-x владелец может читать, выполнять и записывать. А остальные только читать и выполнять
- **database.conf** - ---------- все доступы запрещены
![[Pasted image 20251129112940.png]]

4. Не совсем понял как выполнять, но использовал команду `find` и воспользовался помощью ИИ для составления команды: 
![[Pasted image 20251129113914.png]]

5. Что я нашел подозрительного в нашей инфраструктуре: 
- В логах попытка взлома с IP 192.168.1.100
- Пароли лежат в: www/config.php, configs/database.conf
- Проблема с правами: database.conf - нельзя открыть

***Вывод:*** Просканировал системные логи на предмет подозрительной активности с помощью команды `cat`. Нашел все файлы, содержащие пароли, API-ключи и токены при помощи команды `grep`. Проверил права доступа ко всем конфигурационным файлам при помощи команды `ls -la`. Выявил файлы с неправильными или опасными правами доступа при помощи команды `find`. И составил отчет о найденных уязвимостях в нашей инфраструктуре

***Задача 3: Восстановление контроля доступа***
1. Создайте специализированного пользователя `security-auditor` для проведения проверок
2. Настройте корректные права доступа для всей структуры компании (755 для директорий, 644 для файлов)
3. Исправьте проблемные права доступа, обнаруженные в ходе аудита
4. Проверьте и задокументируйте итоговые права доступа
5. Создайте инструкцию по управлению правами для новых сотрудников

***Решение:*** 
1. Мы создали пользователя security-auditor при помощи команды `adduser`: 
![[Pasted image 20251129115140.png]]

2. Использовал команду chmod для выдачи прав директорий (755) и папок (644): 
![[Pasted image 20251129115822.png]]

3. Так же использую команду `chmod`, в первый раз у нас возникала проблема исправления, из за того, что у файла `database.conf` установлены права **000** (никто не имеет доступа), поэтому даже владелец не может его изменить. Нужно использовать `sudo` для принудительного изменения прав: 
![[Pasted image 20251129120207.png]]

4. И проверяем, что получилось: 
![[Pasted image 20251129120538.png]]

5. Инструкцию пишем в тестовом редакторе nano: 

ИНСТРУКЦИЯ: 

Папки: права 755 
Файлы: права 644 

Команды: 
ls -la - посмотреть права
chmod 755 имя_папки - исправить папку
chmod 644 имя_файла - исправить файл

***Вывод:*** Создал специализированного пользователя для проведения проверок с помощью команды adduder. Настроил корректные права доступа для всей структуры компании использую команду chmod. Исправил проблемные права доступа, обнаруженные в ходе аудита так же при помощи команды chmod. Проверил и задокументировал итоговые права доступа, проверил их при помощи команды ls -ls. И создал документацию по управлению правами для новых сотрудников

**Задача 4: Управление дисковым пространством**
1. Проведите анализ использования дискового пространства в системе
2. Определите топ-3 самых объемных файлов и директорий
3. Создайте и настройте точки монтирования для резервного копирования
4. Организуйте систему временного хранения больших файлов
5. Разработайте план очистки и оптимизации дискового пространства

